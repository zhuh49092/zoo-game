/* ========== Global Reset ========== */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
img,video{max-width:100%;display:block}

/* 统一变量：舞台宽、引导层级、浮标层级、宝箱尺寸 */
:root{
  --stageW: min(100vw, 720px);
  --z-floating: 2147483647;      /* 浮动按钮 */
  --z-guide:    2147483648;      /* 引导蒙层（最高） */
  --z-guide-ui: 2147483649;      /* 蒙层内按钮 */
  --pinSize: clamp(44px, 9vw, 72px); /* 地图宝箱大小，随屏缩放并有上下限 */
}

/* 安全区与动态视口：通用首屏容器 */
.page{
  width:100vw;
  min-height:100dvh;              /* 关键：动态视口高度，iOS 地址栏不吞内容 */
  background:#000;
}

/* ========== 模式 A：流式 9:16 舞台（index / intro / reward 用） ========== */
.stage-fluid{
  width:var(--stageW);
  min-height:100dvh;
  margin:0 auto;
  position:relative;
  overflow:hidden;
  background:#000;
}
.stage-fluid > .fill-cover{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:cover;                /* 重要：铺满但不变形 */
}

/* 引导蒙层（必须是舞台容器的子元素，才能与底图同缩放） */
.guide-layer{
  position:absolute; inset:0;
  display:none; align-items:center; justify-content:center;
  z-index:var(--z-guide);
  background:transparent;
  touch-action:manipulation;
}
.guide-layer.show{ display:flex; }
.guide-layer img{
  width:100%; height:100%;
  object-fit:cover; max-width:none; max-height:none;
  -webkit-user-drag:none; user-select:none; pointer-events:none;
}
.guide-layer .guide-skip{
  position:absolute; right:12px; top:calc(12px + env(safe-area-inset-top));
  padding:6px 14px; border:0; border-radius:999px;
  background:rgba(0,0,0,.35); color:#fff; font-weight:700; font-size:16px;
  cursor:pointer; z-index:var(--z-guide-ui);
}

/* 浮动快捷按钮（示例用在 index） */
.floating-nav{
  position:fixed;
  left:calc((100vw - var(--stageW))/2 + 22px);
  top:calc(env(safe-area-inset-top) + 112px);
  z-index:var(--z-floating);
  display:flex; flex-direction:column; gap:12px;
}
.floating-nav a{
  width:clamp(56px, 8vw, 80px); height:clamp(56px, 8vw, 80px);
  display:inline-flex; align-items:center; justify-content:center;
}
.floating-nav img{ width:100%; height:100%; object-fit:contain; }

/* 地图宝箱/卷轴：随舞台宽度缩放 */
.pin{
  position:absolute; transform:translate(-50%,-50%);
  width:var(--pinSize); height:var(--pinSize);
  background-repeat:no-repeat; background-position:center; background-size:contain;
  cursor:pointer; z-index:5;
}
.pin:active{ transform:translate(-50%,-48%); }

/* ========== 模式 B：固定 720×1280 画布 + 等比缩放（spirit 用） ========== */
.stage-fixed-outer{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  overflow:hidden; background:#000;
  --scale: min(calc(100vw / 720), calc(100dvh / 1280));
}
.stage-fixed-canvas{
  position:relative; width:720px; height:1280px; overflow:hidden; background:#fff;
  transform:scale(var(--scale)); transform-origin:top center;
}

/* spirit 内部常用层（示例） */
.sp-bg{ position:absolute; inset:0; background:#000; z-index:0; }
.sp-content{ position:absolute; inset:0; z-index:1; }
.sp-playground{ position:absolute; left:0; right:0; top:360px; bottom:0; overflow:hidden; }

/* 奖励页常用层级 */
.rw-white{ position:absolute; inset:0; background:#fff; opacity:0; pointer-events:none; z-index:10; transition:opacity 2s linear; }
.rw-white.show{ opacity:1; }
.rw-showcase{ position:absolute; inset:0; display:none; z-index:11; }
.rw-showcase.show{ display:block; }
.rw-layer{ position:absolute; left:0; right:0; display:flex; justify-content:center; pointer-events:none; }
.rw-confetti{ position:absolute; inset:0; pointer-events:none; overflow:hidden; z-index:20; }
.rw-btn-wrap{ position:absolute; left:0; right:0; top:63%; display:flex; justify-content:center; z-index:16; }
.rw-btn{ pointer-events:auto; border:none; background:transparent; padding:0; cursor:pointer; }

/* 工具类 */
.hide{ display:none !important; }
